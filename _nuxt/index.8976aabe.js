import W from"./button.esm.c233e1d0.js";import{s as ce}from"./dropdown.esm.097ea475.js";import de from"./checkbox.esm.e20ba71e.js";import re from"./menu.esm.57f71878.js";import pe from"./inputtext.esm.f54f7e7c.js";import _e from"./image.esm.43b5e7c1.js";import{u as X}from"./useNotifToast.35453648.js";import{r as c,g as j,o,c as a,b as u,a as e,t as r,u as s,x as q,F as k,y as w,z as M,w as h,v as $,A as J,n as ue,d as O,q as fe,B as me,C as he,D as K,p as be,e as xe}from"./entry.d008ba6d.js";import{_ as ve}from"./_plugin-vue_export-helper.c27b6911.js";import"./badge.esm.09832455.js";import"./basecomponent.esm.8e553a4b.js";import"./index.esm.51105741.js";import"./baseicon.esm.ae8d05ed.js";import"./index.esm.9aad9a8c.js";import"./index.esm.3a2b13d8.js";import"./overlayeventbus.esm.e8b3193e.js";import"./portal.esm.94d64a71.js";import"./virtualscroller.esm.2cfaa20d.js";import"./index.esm.35f1050a.js";import"./index.esm.fd70cdda.js";const ye={key:0,class:"bg-white fixed w-screen h-screen top-0 left-0 z-[1010] overflow-auto"},ge={class:"md:w-[900px] w-[100%] mx-auto flex flex-col"},ke={class:"flex border p-2 my-5"},we={class:"flex flex-col"},$e=e("span",{class:"text-sm font-bold"}," Réf. Publoc ",-1),Ce={class:""},Ve={class:"flex flex-col ml-5"},Re=e("span",{class:"text-sm font-bold"}," Réf. Régissseur ",-1),Se={class:""},Ae={class:"flex flex-col ml-5"},Ie=e("span",{class:"text-sm font-bold"}," Régissseur ",-1),je={class:""},De={class:"flex border mb-5 p-2"},Pe={class:"flex flex-col"},Te=e("span",{class:"text-sm font-bold"}," Catégorie ",-1),Ue={class:""},Ee={class:"flex flex-col ml-5"},Ne=e("span",{class:"text-sm font-bold"}," Format ",-1),ze={class:""},Be={class:"flex border mb-5"},Le={key:0,class:"w-full"},Fe=e("div",{class:"p-1 border-b border-dashed"},[e("span",{class:"text-sm font-bold"}," Ce panneau est disponible ")],-1),Me=[Fe],Oe={key:1,class:"w-full"},qe=e("div",{class:"p-1 border-b border-dashed"},[e("span",{class:"text-sm font-bold"}," Ce panneau est en location ")],-1),He={class:"flex flex-col p-2 w-full"},Qe={class:"flex flex-col"},Ge=e("span",{class:"text-sm font-bold"}," Date de début de location ",-1),Je={class:""},Ke={class:"flex flex-col"},We=e("span",{class:"text-sm font-bold"}," Nombre de Mois ",-1),Xe={class:""},Ye={class:"flex flex-col"},Ze=e("span",{class:"text-sm font-bold"}," Annonceur ",-1),es={class:""},ss={key:2,class:"w-full"},ts=e("div",{class:"p-1 border-b border-dashed"},[e("span",{class:"text-sm font-bold"}," Ce panneau n'est pas disponible ")],-1),os=[ts],ls={class:"flex flex-col border mb-5"},ns=e("div",{class:"border-b border-dashed p-1"},[e("span",{class:"font-bold text-sm"}," Emplacement ")],-1),as={class:"flex flex-col p-2"},is={class:"flex flex-col mb-2"},cs=e("span",{class:"text-sm font-bold"}," Lieu dit ",-1),ds={class:""},rs={class:"flex flex-col mb-2"},ps=e("span",{class:"text-sm font-bold"}," Ville ",-1),_s={class:""},us={class:"flex flex-col mb-2"},fs=e("span",{class:"text-sm font-bold"}," Région ",-1),ms={class:""},hs={class:"flex flex-col mb-2"},bs=e("span",{class:"text-sm font-bold"}," Quartier ",-1),xs={class:""},vs={class:"flex flex-col border mb-5"},ys=e("div",{class:"border-b border-dashed p-1"},[e("span",{class:"font-bold text-sm"}," Images en mode Disponible ")],-1),gs={key:0,class:"flex flex-wrap p-2"},ks=e("i",{class:"pi pi-search"},null,-1),ws=["src"],$s=["src","onClick"],Cs={key:1,class:"flex justify-center items-center p-5"},Vs=e("span",{class:"font-bold text-gray-500"}," Aucune photo en mode dispo ",-1),Rs=[Vs],Ss={class:"flex flex-col border mb-5"},As=e("div",{class:"border-b border-dashed p-1"},[e("span",{class:"font-bold text-sm"}," Images en mode pose ")],-1),Is={key:0,class:"flex flex-wrap p-2"},js=e("i",{class:"pi pi-search"},null,-1),Ds=["src"],Ps=["src","onClick"],Ts={key:1,class:"flex justify-center items-center p-5"},Us=e("span",{class:"font-bold text-gray-500"}," Aucune photo en mode pose ",-1),Es=[Us],Ns={class:"flex flex-col border mb-5"},zs=e("div",{class:"border-b border-dashed p-1"},[e("span",{class:"font-bold text-sm"}," Images Solarpro ")],-1),Bs={key:0,class:"flex flex-wrap p-2"},Ls=e("i",{class:"pi pi-search"},null,-1),Fs=["src"],Ms=["src","onClick"],Os={key:1,class:"flex justify-center items-center p-5"},qs=e("span",{class:"font-bold text-gray-500"}," Aucune photo Solarpro ",-1),Hs=[qs],Qs={__name:"AdminViewPanel",props:["visible","pan_id","prefix_api"],emits:["close"],setup(b,{emit:I}){const{setErrorServer:N,setNotifToast:z}=X(),x=b,p=I,l=c({});async function D(){try{const d=await $fetch(`${x.prefix_api}/a/ad/panel/${x.pan_id}`,{method:"get"});d.status?l.value=d.pan_infos:z({summary:"Récupération des données",detail:d.message,severity:"error"})}catch(d){console.error(d),N()}}return j(()=>x.visible,d=>{d&&D()}),(d,v)=>{const B=W,C=_e;return b.visible?(o(),a("div",ye,[u(B,{onClick:v[0]||(v[0]=_=>p("close")),icon:"pi pi-times",severity:"danger",rounded:"","aria-label":"Cancel",class:"fixed top-2 right-2 shadow-lg"}),e("div",ge,[e("div",ke,[e("div",we,[$e,e("span",Ce,r(s(l).pan.pan_publoc_ref),1)]),e("div",Ve,[Re,e("span",Se,r(s(l).pan.pan_ref),1)]),e("div",Ae,[Ie,e("span",je,r(s(l).pan.reg_label),1)])]),e("div",De,[e("div",Pe,[Te,e("span",Ue,r(s(l).pan.category_label||"-"),1)]),e("div",Ee,[Ne,e("span",ze,r(s(l).pan.format_label||"-"),1)])]),e("div",Be,[s(l).pan.pan_state==1?(o(),a("div",Le,Me)):s(l).pan.pan_state==3?(o(),a("div",Oe,[qe,e("div",He,[e("div",Qe,[Ge,e("span",Je,r(new Date(s(l).loc_infos.pan_loc_date_debut).toLocaleDateString()),1)]),e("div",Ke,[We,e("span",Xe,r(s(l).loc_infos.pan_loc_month),1)]),e("div",Ye,[Ze,e("span",es,r(s(l).loc_infos.ann_label),1)])])])):s(l).pan.pan_state==4?(o(),a("div",ss,os)):q("",!0)]),e("div",ls,[ns,e("div",as,[e("div",is,[cs,e("span",ds,r(s(l).pan.lieu_label),1)]),e("div",rs,[ps,e("span",_s,r(s(l).pan.lieu_ville),1)]),e("div",us,[fs,e("span",ms,r(s(l).pan.lieu_region||"-"),1)]),e("div",hs,[bs,e("span",xs,r(s(l).pan.lieu_quartier||"-"),1)])])]),e("div",vs,[ys,s(l).photo_dispo?(o(),a("div",gs,[(o(!0),a(k,null,w(s(l).photo_dispo,_=>(o(),M(C,{key:_.file_id,class:"mr-2 mb-2",alt:"Image",preview:""},{indicatoricon:h(()=>[ks]),image:h(()=>[e("img",{src:`/api/p/media/${_.name_min_file}`,alt:"image",width:"100"},null,8,ws)]),preview:h(m=>[e("img",{src:`/api/p/media/${_.name_file}`,alt:"preview",style:$(m.style),onClick:m.onClick},null,12,$s)]),_:2},1024))),128))])):(o(),a("div",Cs,Rs))]),e("div",Ss,[As,s(l).photo_pose?(o(),a("div",Is,[(o(!0),a(k,null,w(s(l).photo_pose,_=>(o(),M(C,{key:_.file_id,class:"mr-2 mb-2",alt:"Image",preview:""},{indicatoricon:h(()=>[js]),image:h(()=>[e("img",{src:`/api/p/media/${_.name_min_file}`,alt:"image",width:"100"},null,8,Ds)]),preview:h(m=>[e("img",{src:`/api/p/media/${_.name_file}`,alt:"preview",style:$(m.style),onClick:m.onClick},null,12,Ps)]),_:2},1024))),128))])):(o(),a("div",Ts,Es))]),e("div",Ns,[zs,s(l).photo_solarpro?(o(),a("div",Bs,[(o(!0),a(k,null,w(s(l).photo_solarpro,_=>(o(),M(C,{key:_.file_id,class:"mr-2 mb-2",alt:"Image",preview:""},{indicatoricon:h(()=>[Ls]),image:h(()=>[e("img",{src:`/api/p/media/${_.name_min_file}`,alt:"image",width:"100"},null,8,Fs)]),preview:h(m=>[e("img",{src:`/api/p/media/${_.name_file}`,alt:"preview",style:$(m.style),onClick:m.onClick},null,12,Ms)]),_:2},1024))),128))])):(o(),a("div",Os,Hs))])])])):q("",!0)}}},Gs=Qs;const A=b=>(be("data-v-6f3b73ce"),b=b(),xe(),b),Js={class:"h-full overflow-auto flex-grow flex flex-col"},Ks=A(()=>e("span",{class:"flex-grow"},null,-1)),Ws={class:"flex items-end justify-center"},Xs={class:"border border-purple-500 rounded p-2 mr-5 min-w-[150px] text-center bg-white"},Ys={class:"border rounded p-2 mr-5 min-w-[150px] text-center bg-white"},Zs={class:"border rounded p-2 mr-5 w-[150px] text-center bg-white"},et={class:"flex flex-col"},st=A(()=>e("span",{class:"text-xs font-bold"}," Page ",-1)),tt={class:"flex flex-col text-sm"},ot={class:""},lt={class:""},nt={class:"text-center border"},at=["onClick"],it={class:"bg-gray-50 min-h-[50px] items-center flex border-t w-full sticky bottom-0 justify-center"},ct={class:"px-5"},dt=A(()=>e("span",{class:"underline-text"}," Sélections :",-1)),rt={class:"underline-text-purple font-bold text-xl"},pt={class:"ml-2"},_t={class:"flex items-center p-2 bg-gray-50 sticky top-0 z-50"},ut={key:0,class:"uppercase font-bold flex-grow text-center"},ft={class:"flex flex-col px-2"},mt={class:"flex flex-col mb-2 border-b py-2"},ht=A(()=>e("span",{class:"text-xs font-bold"}," Etat ",-1)),bt={class:"flex justify-end p-2 border-b mb-2"},xt={class:"flex justify-end"},vt={class:"flex flex-col"},yt=A(()=>e("span",{class:"text-xs font-bold"}," Rechercher ",-1)),gt={class:"flex flex-col"},kt=A(()=>e("span",{class:"text-xs font-bold"}," Par ",-1)),wt={__name:"index",props:["heightHeader","prefix_api","heightContainer"],setup(b){const I=b,{setErrorServer:N,setNotifToast:z}=X(),x=c([]),p=c({limit:150,page:1,state:"all"}),l=c(60),D=c([{label:"Ref. Régisseur",key:"pan_ref",w:50},{label:"Ref. Publoc",key:"pan_publoc_ref",w:50},{label:"Régisseur",key:"reg_label"},{label:"Annonceur",key:"ann_label"}]);c([]);const d=c({}),v=c(!1);j(d.value,t=>{const i=Object.keys(t),f=m(i,d.value);v.value=f>0});function B(){if(v.value)C();else for(let t=0;t<x.value.length;t++){const i=x.value[t];d.value[i.pan_id]=!0}}function C(){const t=Object.keys(d.value);for(let i=0;i<t.length;i++){const f=t[i];delete d.value[f]}}const _=J(()=>{const t=Object.keys(d.value);return m(t,d.value)});function m(t,i){return t.reduce((S,U)=>i[U]?S+1:S,0)}const L=c(!1),P=c(null),H=c(),Y=c([{label:"Options",items:[{label:"Refresh",icon:"pi pi-refresh"},{label:"Export",icon:"pi pi-upload"}]}]),Z=t=>{H.value.toggle(t)},ee=c([{label:"Ref. Régisseur",key:"pan_ref"},{label:"Ref. Publoc",key:"pan_publoc_ref"},{label:"Régisseur",key:"reg"},{label:"Annonceur",key:"ann"},{label:"Ville",key:"ville"},{label:"Quartier",key:"quartier"},{label:"Lieu dit",key:"lieu_label"}]),se=c([{label:"Tous",key:"all"},{label:"Dispo",key:"1"},{label:"En réservation",key:"2"},{label:"En Location",key:"3"},{label:"Indisponible",key:"4"}]),y=c([{search:"",search_by:"pan_ref",id:1}]),Q=c(300),V=c(!0);c("pan_publoc_ref"),j(V,t=>{Q.value=t?300:50}),j(y.value,t=>{p.value.page=1,T()}),j(()=>p.value.state,()=>{p.value.page=1,T()});const F=c(!1),G=c(0),R=c(0),te=J(()=>{const t=Math.ceil(R.value/p.value.limit);return R.value>0?Array.from({length:t},(i,f)=>f+1):[1]});function oe(){const t=y.value[y.value.length-1];y.value.push({search:"",search_by:"pan_ref",id:t.id+1})}function le(t){y.value.splice(t,1)}async function T(){F.value=!0,C();try{const t=await $fetch(`${I.prefix_api}/a/ad/panels`,{method:"get",query:{filters:p.value,search_filters:y.value}});t.status?(x.value=t.panels,G.value=t.nb_total_panel,R.value=t.nb_total_resultat):z({severity:"error",detail:t.message,summary:"récupération des Liste des panneaux"})}catch(t){console.error(t),N()}F.value=!1}return ue(()=>{T()}),(t,i)=>{const f=W,S=ce,U=de,ne=re,ae=pe,ie=Gs;return o(),a("div",{class:"flex h-full overflow-auto",style:$({height:`${I.heightContainer}px`})},[e("div",Js,[e("div",{class:"border-b sticky flex items-center top-0 bg-gray-50 px-2 z-50",style:$({minHeight:`${s(l)}px`})},[u(f,{loading:s(F),icon:"pi pi-refresh ",onClick:T,class:"p-button-sm p-1 p-button-text p-button-help",label:"Actualiser"},null,8,["loading"]),Ks,e("div",Ws,[e("div",Xs,[O(" Total Résultat : "),e("strong",null,r(s(R)),1)]),e("div",Ys,[O(" Total Panneau : "),e("strong",null,r(s(G)),1)]),e("div",Zs,[e("strong",null,r((s(p).page-1)*s(p).limit+1),1),O(" à "),e("strong",null,r(s(p).page*s(p).limit>s(R)?s(R):s(p).page*s(p).limit),1)]),e("div",et,[st,u(S,{class:"p-0 p-inputtext-sm text-xs",options:s(te),modelValue:s(p).page,"onUpdate:modelValue":i[0]||(i[0]=n=>s(p).page=n)},null,8,["options","modelValue"])])])],4),e("div",tt,[e("table",ot,[e("thead",lt,[e("tr",{class:"bg-gray-50 sticky z-50",style:$({top:`${s(l)}px`})},[e("th",null,[u(U,{binary:!0,modelValue:s(v),"onUpdate:modelValue":i[1]||(i[1]=n=>fe(v)?v.value=n:null),onClick:B},null,8,["modelValue"])]),(o(!0),a(k,null,w(s(D),n=>(o(),a("th",{class:"border-x uppercase text-left px-2",style:{},key:n.key},r(n.label),1))),128))],4)]),e("tbody",null,[(o(!0),a(k,null,w(s(x),n=>(o(),a("tr",{class:K([{"bg-green-200/20":s(d)[n.pan_id]&&n.pan_id!=s(P),"bg-purple-300/30":s(P)==n.pan_id},""]),key:n.pan_id},[e("td",nt,[u(U,{modelValue:s(d)[n.pan_id],"onUpdate:modelValue":g=>s(d)[n.pan_id]=g,binary:!0},null,8,["modelValue","onUpdate:modelValue"])]),(o(!0),a(k,null,w(s(D),g=>(o(),a("td",{class:K([{"underline cursor-pointer":g.key=="pan_ref"},"border p-2"]),onClick:()=>{g.key=="pan_ref"&&(L.value=!0,P.value=n.pan_id)},key:g.key},r(n[g.key]||"-"),11,at))),128))],2))),128))])])]),e("div",it,[e("div",ct,[dt,e("span",rt,r(s(_)),1)]),e("div",pt,[u(f,{icon:"pi pi-ellipsis-v",class:"h-[32px] w-[32px]",onClick:Z}),u(ne,{ref_key:"menu_selection",ref:H,id:"overlay_menu",model:s(Y),popup:!0},null,8,["model"])])])]),e("div",{class:"h-full border-l transition-all bg-gray-50 flex flex-col overflow-auto",style:$({width:`${s(Q)}px`})},[e("div",_t,[u(f,{icon:s(V)?"pi pi-times":"pi pi-sliders-h",text:"",onClick:i[2]||(i[2]=()=>{V.value=!s(V)}),class:"p-0 text-sm h-[30px] w-[30px]"},null,8,["icon"]),s(V)?(o(),a("span",ut," Filtres ")):q("",!0)]),me(e("div",ft,[e("div",mt,[ht,u(S,{modelValue:s(p).state,"onUpdate:modelValue":i[3]||(i[3]=n=>s(p).state=n),options:s(se),"option-label":"label","option-value":"key",class:"dropdown-sm p-inputtext-sm"},null,8,["modelValue","options"])]),e("div",bt,[u(f,{icon:"pi pi-plus p-button-sm",label:"Ajouter un filtre",onClick:oe,class:"p-0",text:""})]),(o(!0),a(k,null,w(s(y),(n,g)=>(o(),a("div",{class:"flex flex-col border p-2 rounded mb-2",key:n.id},[e("div",xt,[u(f,{onClick:E=>le(g),disabled:s(y).length==1,text:"",icon:"pi pi-times",class:"p-button-sm p-0 h-[20px] w-[20px] p-button-help"},null,8,["onClick","disabled"])]),e("div",vt,[yt,u(ae,{placeholder:"Recherche",class:"p-inputtext-sm p-1 mb-2",modelValue:n.search,"onUpdate:modelValue":E=>n.search=E},null,8,["modelValue","onUpdate:modelValue"])]),e("div",gt,[kt,u(S,{modelValue:n.search_by,"onUpdate:modelValue":E=>n.search_by=E,options:s(ee),class:"dropdown-sm p-inputtext-sm","option-label":"label","option-value":"key"},null,8,["modelValue","onUpdate:modelValue","options"])])]))),128))],512),[[he,s(V)]])],4),u(ie,{prefix_api:I.prefix_api,visible:s(L),onClose:i[4]||(i[4]=n=>L.value=!1),pan_id:s(P)},null,8,["prefix_api","visible","pan_id"])],4)}}},qt=ve(wt,[["__scopeId","data-v-6f3b73ce"]]);export{qt as default};
